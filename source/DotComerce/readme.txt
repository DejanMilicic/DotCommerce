DotCommerce.SqlServer
=====================

Steps for integration of DotCommerce with SqlServer persistence layer into your project

1. Run script below to create tables needed for DotCommerce
2. Add connection string named "DotCommerce" to the web.config of the project
3. In Dependency injection configuration, register DotCommerceApi as implementing IDotCommerceApi
4. Implement IShippingCalculator and register in DependencyInjection
5. Since EF 6.1 created default configuration targeting local database, change this to
	<entityFramework>
		<defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" />
	</entityFramework>

=== TSQL ===

DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
	SELECT @CurrentMigration =
		(SELECT TOP (1) 
		[Project1].[MigrationId] AS [MigrationId]
		FROM ( SELECT 
		[Extent1].[MigrationId] AS [MigrationId]
		FROM [dbo].[__MigrationHistory] AS [Extent1]
		WHERE [Extent1].[ContextKey] = N'DotCommerce.Migrations.Configuration'
		)  AS [Project1]
		ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
	SET @CurrentMigration = '0'

IF @CurrentMigration < '201505121543188_Initial'
BEGIN
	CREATE TABLE [dbo].[OrderLine] (
		[Id] [int] NOT NULL IDENTITY,
		[ItemId] [nvarchar](max),
		[ItemName] [nvarchar](max),
		[ItemPrice] [decimal](18, 2) NOT NULL,
		[ItemDiscount] [decimal](18, 2) NOT NULL,
		[ItemWeight] [int] NOT NULL,
		[ItemUrl] [nvarchar](max),
		[ItemImageUrl] [nvarchar](max),
		[Weight] [int] NOT NULL,
		[Quantity] [int] NOT NULL,
		[Price] [decimal](18, 2) NOT NULL,
		[Order_Id] [int] NOT NULL,
		CONSTRAINT [PK_dbo.OrderLine] PRIMARY KEY ([Id])
	)
	CREATE INDEX [IX_Order_Id] ON [dbo].[OrderLine]([Order_Id])
	CREATE TABLE [dbo].[Order] (
		[Id] [int] NOT NULL IDENTITY,
		[UserId] [nvarchar](max),
		[Status] [nvarchar](max),
		[CreatedOn] [datetime] NOT NULL,
		[LastUpdated] [datetime] NOT NULL,
		[ItemsCount] [int] NOT NULL,
		[Weight] [int] NOT NULL,
		[Price] [decimal](18, 2) NOT NULL,
		CONSTRAINT [PK_dbo.Order] PRIMARY KEY ([Id])
	)
	ALTER TABLE [dbo].[OrderLine] ADD CONSTRAINT [FK_dbo.OrderLine_dbo.Order_Order_Id] FOREIGN KEY ([Order_Id]) REFERENCES [dbo].[Order] ([Id]) ON DELETE CASCADE
	CREATE TABLE [dbo].[__MigrationHistory] (
		[MigrationId] [nvarchar](150) NOT NULL,
		[ContextKey] [nvarchar](300) NOT NULL,
		[Model] [varbinary](max) NOT NULL,
		[ProductVersion] [nvarchar](32) NOT NULL,
		CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
	)
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505121543188_Initial', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5ACD6EE33610BE17E83B083AB545D64AB2976D60EF2275922268FE1A27DBDE025A1A3BC452944A52A983A24FD6431FA9AFD0A1FE4549B6E4BF5D14452E32457E331CCE7C9A19E69FBFFE1E7E58F8CC7A012169C047F6D1E0D0B680BB8147F97C64476AF6E69DFDE1FDD75F0DCF3D7F617DCCE6BDD5F370259723FB59A9F0C471A4FB0C3E91039FBA2290C14C0DDCC077881738C78787DF3B47470E20848D589635BC8FB8A23EC43FF0E738E02E842A22EC3AF080C9741CDF4C6254EB86F82043E2C2C83E0BD438F07D102E0C2EF94C10A944E4AA48C0E01C41D5EB85C0C9BF07E2936D9D324A50C309B0996D11CE034514EA7FF22861A244C0E7931007087B780D01E7CD089390EEEBA498DE758B87C77A8B4EB130837223A902BF27E0D1DBD4668EB97C2DCBDBB94DD1AA89A1F4AE63CB8EECF3D9ADF0405C518EFB37E59D8C99D073FBD83EF94D410E4AD0075609E020F726743AFD77608D23A6B1461C2225083BB0EEA229A3EE4FF0FA107C023EE21163E57DE04EF05D650087EE44108250AFF7304B7777E9D996535DE7980BF365A535C9A62FB97A7B6C5B37289C4C19E46E5232D04405027E040E8228F0EE885220B8C680D82A35E9A62C057E210F3D1383CFB6AEC9E20AF85C3D8F6C7CB4AD0BBA002F1B497578E414631517E139401731FA692F82EE0475734967E0529F30DBBA13F89452CD3BDB9AB8441BB4C9BAAB259C51E906C8233B15F20BD0F9B35AE50AAB711E05DB8BD92F7D32877D08DB86617E8E481A1F9BA06CD9D36EC80B9DC7616DC88969CCB6EE81C56FE5330D934F4B46714F39D14934B008FCFB8015DC5A7AFBF440C41CB4F182D629932012AEA1DDD02988BB0B9DEF88CAFFA7F166599855883DD0F804B58DE4CEC58C05682BDCF23CB4F0E703D59F8F9E017A85BEF5187A1A6D632CCD71725CA6FDF548631BF4B557E24969651BEC9351CB12F6C908AA0BFB9C4A19B834D6AA4A3F658DAA5B3DE79EB55ABDC4BF4B5B442F476AA1219209EA81F6B54DD2B8E567C0408175EA2689F6984897787563E35EBC1E3AE5845DD3294999AB7A7D671AAE64A23A6F63F1A308A288D47A67D306DE466E49A95BA6E16B6AAFA126A01A7CA638B626D59D0E404B406A00A5BD16284D3E5A9AD8EEC9E60177F29C7C0F85FA4E2FA0ECB84DA05473D397AA5B6E0899FC888BC2D6492ADBAC02765A4AE0E135094324F852499C8E5893A41E1EBF99F42F08FD04C37165435D986B9B4BC2EF22A695C65B148D9A5E502115D2399912CD6963CFAF4D43876EF1B14C40CD67EBA795795FB6443FA7F1D223932939BE21A2302C4E9FFBF8C58FB70D251758BA3AEE551046444302320E58E4F3B62466E9EAB432AC20A463FD5092C2CFC44946FB21A59F3D132A1DEE8755D470265CF1A61F62F66137F1B2F17E6871256542C5833DCF302FCB6A2799BFE98ED8B4C7FEFB2BAAAF324E31DA1DA9C1235ABD61E818616686BA538BF5DA97BBCA1EDDB965D7BCB23EA7EC8B4FB212A58C908D7547C92A90324A36D61DA5546094814AC3DDB12A254619ADF2A25FCC66658619B1D9F8BEE3F54B8AB26AC6530DB5A65C6F93A8AA00F5F826EB14CF30617BCE58B760A7E84BE09AA227AE30B2D56B699626A16B6AD64F273387AD1F7A2D9535A7E42E97A7B446EA3A4CD3C8D5573CB5BC3299A26BEBE0857A3AA79CBC4A0CC5819E3098FCC6C68C828EC96CC235E1740652250D27FBF8F0E8D8B80DFA726E661C293DD6FD7A66EF8D33AA0DBBB235B6461FA710C15F88709F89F8C6278B6FCB58EB5C6B6C0C56E9EB78FBB8BAD889906A8B2B3EC5CD2E2E3636AC7939B111E0E6DB33AF1FD6C1D8ADAF149F979286B5DED025F76031B2FF88179D5897BF3E65EB0EACF8E9C43AB4FE5C21BCF7DDC27F8387AA3DFB8D1CB2DA97DF08AAD67BD709ACDA52EF7D6DAC7AEF7D9D88D93C6EB71973BB6C6A7FFE1676D2E15DAB698D7018B820745C1186591FE6E998F7D50A093C0CEED2903063EFF5B4B50B1FE86DE588E69B330881EB406FD8641771CB92F51CDBB0F12A1BF4ECEDD73BA6CBBBEF95F35ADEC74F72640C886980479E387CF7367FEE9EED7DFE56019FFB0AA0D2A76FB996688F8E966272274DFE7A05841E56FA5738747149E70584FEC7380E6EC5B7F239583D0799931B1A65530CE2BC064590FDC9A95074465C85AF5D9032BE3FFE4858A44DE34FC1BBE4B7910A23855B067FCA2ABD401D2ACBE4C73719559D87B7617C65B98D2DA09A547FC06EF90F11655EAEF74503B5B740E8184C33087D964A6712F3D71CE926304FBF0D28355F4E1D0FE0870CC1E42D9F90175847374C47AE604EDCD7AC906D07597D1055B30FCF28990BE2CB14A3588F3FD1873D7FF1FE5F933071F4112A0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505122104370_Corrections1'
BEGIN
	ALTER TABLE [dbo].[Order] ADD [OrderLinesPrice] [decimal](18, 2) NOT NULL DEFAULT 0
	ALTER TABLE [dbo].[Order] ADD [Shipping] [decimal](18, 2) NOT NULL DEFAULT 0
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505122104370_Corrections1', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5ACD6EE33610BE17E83B083AB545D64AB2976D60EF2275B285D1FC354AB6BD2D1869EC104B512A49A5098A3E590F7DA4BE4287FA1725D992FFB62D8A5C648AFC66389CF938A3C95F7FFC397EF71C30EB0984A4219FD847A343DB02EE853EE58B891DABF9AB37F6BBB75F7E313EF78367EB433EEFB59E872BB99CD88F4A45278E23BD4708881C05D413A10CE76AE4858143FCD0393E3CFCD6393A7200216CC4B2ACF16DCC150D20F9813FA721F72052316197A10F4C66E3F8C64D50AD2B12808C880713FB2C54D330084078309AF1B9205289D853B180D13982AA97F70227FF1A8A4FB675CA28410D5D6073DB229C878A28D4FFE45E82AB44C8176E840384DDBD4480F3E68449C8F675524EEFBBC5C363BD45A75C984379B154613010F0E8756633C75CBE96E5EDC2A668D5D4507AD7896527F6F9FC5AF8202E28C7FD9BF24EA64CE8B9436C9FFEA6204715E803AB02705078133A9DFE3BB0A631D358130EB112841D5837F103A3DE0FF072177E023EE13163D57DE04EF05D6D00876E441881502FB730CF7637F36DCBA9AF73CC85C5B2CA9A74D333AE5E1FDBD6150A270F0C0A37A918C855A180EF8183200AFC1BA21408AE3120B14A43BA294B4150CA43CFC4E0B3AD4BF27C017CA11E27363EDAD67BFA0C7E3E92E970CF29C62A2EC273803E62F4D35E04DD08EA1592CEC0A30161B67523F029A39A37B6E57A441BB4CDBAAB259C51E985C8233B15F213D0C5A35AE50AAB71EE05DB8BD9670159C03E846DC3303FC6248B8F4D50B6EC6957E4892E92B036E42434665BB7C092B7F29146E9D59253DCC782E8241A5884C16DC84A6EADBCFD7847C402B4F1C2CE296E180BCFD06EEC94C4DD87CE7744E5FFD378BB2CCC2AC41E68DC456D63B973315301DA0AD7BC082DFC7947F5F53130402FD0B7EE235FA36D8CA5394E4EABB4BF1E696C83BECA68DDED65E722D344C921EF48C05E1934E3C76DD068CE914B683467DA3E347A2A65E8D144AB3A8F5635AA6FF59CFBD66AF5D240AD6C11C315399246C88AA807DAD736D9EF9A9F010305D6A997560C53223DE2378D8D7BF107E854DC3C0D9DD2DCBFAED737A6E12A266A5E4058C529822822B3DED943CB05842499DD4132E321537B0DE5826AF199F2D8DA54777A002D01690054F65AA2B4F9686562B7279B07DCCB738A3D94EA3B8380F2E3368132CD4D5FAA6FB925648A232E2B74272DD1F352DEE9A8E5C7972421B14A6D9F8D586E5AD84F5FB9C32BDB20C5703CD952E016DA1692F082C7FCD8788BA251D3F7544885F71279209AD3A67ED098860EDDE163B98086CF364F2BF7BE7C897ECEE265404A56717C434469589CBE08307549B60D151758BA3AF9E84218112D99D4346471C0BBB2B1A5ABB312B786908D0D43492B5813271D1D86945D7B2654363C0CAB2C464DB8F2CD30C43C4331F1F2F1616849496842258303CFB0A82F1B2759BCE98FD8B6C7E1FB2BCBC82A4E39DA1FA9C5233ABD61EC18616686BAD388F5C6CD5D678FFEDCB26B5E599F53F6C52779AD5545C8C7FAA3E4A55415251FEB8F52A994AA4095E1FE58B55AA98A567B312C66F37AC98CD87C7CDFF1DAA89BAA708D97034EB3A8936AE7598CFE3B79A09E93D5C9A02D1BDD24EE6B4003B2069D841A26ECCE6A9B16ECC50F295C5B7C273550BE7A2DCDB234794DCD86E96466D9CD436F24DBE694C2E58AA4DB48AEC759A2BBBA9BD6C87CD329BAFA0F9FA8AFB35EF74522598CF48491FB0B9B320A9A35F2099784D33948957EDBB38F0F8F8E8DC6DB3FA709E648E9B3FE9DB0BD7FA3A4DAB02BBF42AEF1C9AC14C19F88F01E89F82A20CF5F57B1D6E9206D0C56FBF2E4EFA34BB41321F5AF89C9296ED623DAD8B0661F6823C0CDB767767AD6C1D8ADAF94D74B45C3C6D7AB19F7E17962FF962C3AB1663F7FCCD71D58C9D3897568FDBE42F8E036CE7F8387EAED918D1CB2DE02D908AAD1E6D029B6DA529B636DAC669B639D88D93C6E3B5A1C5B8F3EB3C5B17501DB547F97FD83CFDF2D483FA6AFD51F40386420109A2008C3F4150B0E4C601B15111E06F7684498B1F766FEDD87D8F4B60A44F3CD1944C03563B56CB28FB8655547816DD878950D06B6519A1FA797373A6AE7B5BC659226FB18100F211E79EAF0FD3B2A857B76B7543A057CEE6E4BAD25D2D101EA8E8E8EAA7827FD946629871E56F9F749747149172584FE674A0E5ECDB78A39333E0F73273734CAA718C479098AE035464E85A273E2297CED819409577F202CD6A6091EC09FF1EB5845B1C22D43F0C06A9F5D75A82C939F348DEA3A8FAFA3A43BBC8D2DA09A54DFC4D7FCBB9832BFD0FB7D0BB57740E818CC52217D964AA7448B9702E92A344FBF0B28335F411D7710440CC1E43577C913ACA31BE65517B020DE4B5E917783AC3E88BAD9C767942C0409648651AEC79FE8C37EF0FCF66FC77C5313452C0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505122146402_ForeignKey'
BEGIN
	EXECUTE sp_rename @objname = N'dbo.OrderLine.Order_Id', @newname = N'OrderId', @objtype = N'COLUMN'
	EXECUTE sp_rename @objname = N'dbo.OrderLine.IX_Order_Id', @newname = N'IX_OrderId', @objtype = N'INDEX'
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505122146402_ForeignKey', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5ADB6EE336107D2FD07F10F4D416592BC9BE6C037B17A9931446736B946CFB1630D2D82196A254924A1D14FDB23EF493FA0B1DEA2ECAB225DF76511479917939331CCE9C2187F9E7AFBF871FE601B35E40481AF2917D3438B42DE05EE8533E1BD9B19ABE79677F78FFF557C3733F985B1FF3716FF5389CC9E5C87E562A3A711CE93D4340E420A09E08653855032F0C1CE287CEF1E1E1F7CED1910308612396650DEF62AE6800C90FFC390EB907918A09BB0A7D60326BC71E3741B5AE490032221E8CECB3508DC32000E1C160C2A7824825624FC50206E708AA5E2F040EFE3D149F6CEB9451821ABAC0A6B645380F1551A8FFC98304578990CFDC081B08BB7F8D00C74D099390ADEBA41CDE758987C77A894E393187F262A9C2A027E0D1DBCC668E397D2DCBDB854DD1AAA9A1F4AA13CB8EECF3E98DF0415C528EEB37E59D8C99D063FBD83EFD4D410E2AD0075605E0A0F026743AFD77608D63A6B1461C6225083BB06EE32746BD9FE0F53EFC047CC463C6AAEBC095605FAD019B6E45188150AF7730CD5637F16DCBA9CF73CC89C5B4CA9C74D113AEDE1EDBD6350A274F0C0A37A918C855A1801F8183200AFC5BA21408AE3120B14A43BA294B4150CA43CFC4E0B3AD2B32BF043E53CF231B3F6DEB82CEC1CF5B321D1E38C558C549B80FD0458CFEDA8BA05B41BD42D219783420CCB66E057E6554F3CEB65C8F68832EB2EE6A0967547A21F2C84E85FC0274F6AC56B9C26A9C07C1F662F6494066B00F61DB30CCCF31C9E2631394DD7A5A425EABC9C000B9262F749670C32238DBBA0396F4CA671AA5F929E7C9C7822D25EE920883BB9095045DE97DBC2762067A07C2D6216E180BCFD06EE894ECDF2527EC281FFC9F0B16CBC2A389D8432E7051DB58EE5CCC5880B6C20D2FE2137FDE539D837AC6E125FAD643E46BB48DB13451CA713577ACC73CDBE0C0325A77CB632E324D946CF28E046C59FDE50C9AF1E3366834E7C825349A336D171A3D9532F468A2559D47AB1AD5977ACE7D6BB57A69A0569688E18A1C49236445D403ED6B9BEC77C3CF808102EBD44BAF1D63223DE2378D8D6BF17BE854649E864EE905A2AED7770D71C8C620341D1286373FCC198472D5A46ECA3D1A11B6D236C6CC8EB4AF975DC8307BCE2002AE197BA511BA082FCE104D0D0A41C686AC32D1D0A9385A338DE31C853340641A9C3D2D48E3986AB24C2E3336377D4043B9A016445EE9FC8B1CC0E900B404A40150596B89B228D22B03DBF9C0DC844EF157ACA154BFB19B9D82C604CA343723B2BEE405C4536C71592C71D26A495E55715ACA2AC32B92A4824A99256BB1DCB4C6327EE3F62F32042986E3C905B58642DB42121E93F0AA62F4A268D4F4820AA930BB9327A233C3D80F1AC3D0A15B7C2C17D0F0D9E66EE5DE974FD1DF59BCF438D8561CBF490619340E9F059A4E92D361C50596CE4EEA5F8411B1E03C3A0E591CF076725B323BAB36D410B2B67E286931C1C4495BFB21658707132A6BEE8755D6054CB8B2A71F627ECE33F1F2F67E68C9EDDC844A1A7BEE6171D56FEC64D1D31D71D11AFBAFAFBCD15771CAD6EE480B3CA2B7371479B78AD29A8C35631AE1DA48D70DCE689CA3EA2CD49DA376CD4FEB73D3BE7829BFF95611F2B6EE28F9C5B68A92B77547A9DC5BAB4095E6EE58B59B6B15ADD6D12FF6F3DBAB19F979FBBEE3BE718B6D445CB5B3C76E16B7D6DA7E16ADBBE1939DF240E3FC660E29A417E738E3BC36CCCE4EABDFCA1A87A97488BE96872FD4D70729F755A2DF0CF48081FB1B1B330ADA81F2015784D329489516DDECE3C3A363E359EDCB79E272A4F459F777AEBD170FA936ECCAF2E01AB5AC52047F21C27B26E29B80CCBFAD62ADF33EB43158AD24E4EFE30D682742EA65BE6417377B01DAD8B0E62BCF46809B2FCF7CC7590763B7BE62BCE2240A36EA2113EEC37C64FF91CC39B126BF3E66D30EACE4E3C43AB4FE5C21BAF7EBCA7F8385EAAF161BB963FD656223A8C6EB833E6BA92DBD3EAC8DD57C7D58275E368FDA969787ADC79EF9F2B07501DB547F9765FDCF5FC44FABB39FA36CBFC7227D4B25EE4B2CCB378B9DCB0BE7B5ED5A5E824F4FFA180F4F21EE78EAEFDD2BF48577B697E85B057CEEEA7DADC4DEF2A2D01E1C2DB5D99DD4E79BF738F4B0CA7F46A2874B3A2B21F4FF4972F06ABE558C99F06998FBB8A1513EC4E0CD2B5004B31839158A4E89A7B0DB032913AAFE4858AC4D133C813FE137B18A62854B86E089D5CA783A5496C94F1E21EA3A0F6FA2E4CD761B4B4035A94EC437FC879832BFD0FB6201B3B740E818CC4E427A2F953E11CD5E0BA4EBD0DCFD36A0CC7C0575DC431031049337DC252FB08E6E78ACBA8419F15EF3EB783BC8EA8DA89B7D7846C94C90406618E57CFC893EEC07F3F7FF02D6AC58DF202C0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505151628445_Addresses'
BEGIN
	CREATE TABLE [dbo].[Address] (
		[Id] [int] NOT NULL IDENTITY,
		[Title] [nvarchar](max),
		[FirstName] [nvarchar](max),
		[LastName] [nvarchar](max),
		[Company] [nvarchar](max),
		[Street] [nvarchar](max),
		[StreetNumber] [nvarchar](max),
		[City] [nvarchar](max),
		[Zip] [nvarchar](max),
		[Email] [nvarchar](max),
		[Phone] [nvarchar](max),
		[SingleAddress] [bit] NOT NULL,
		CONSTRAINT [PK_dbo.Address] PRIMARY KEY ([Id])
	)
	ALTER TABLE [dbo].[Order] ADD [BillingAddress_Id] [int]
	ALTER TABLE [dbo].[Order] ADD [ShippingAddress_Id] [int]
	CREATE INDEX [IX_BillingAddress_Id] ON [dbo].[Order]([BillingAddress_Id])
	CREATE INDEX [IX_ShippingAddress_Id] ON [dbo].[Order]([ShippingAddress_Id])
	ALTER TABLE [dbo].[Order] ADD CONSTRAINT [FK_dbo.Order_dbo.Address_BillingAddress_Id] FOREIGN KEY ([BillingAddress_Id]) REFERENCES [dbo].[Address] ([Id])
	ALTER TABLE [dbo].[Order] ADD CONSTRAINT [FK_dbo.Order_dbo.Address_ShippingAddress_Id] FOREIGN KEY ([ShippingAddress_Id]) REFERENCES [dbo].[Address] ([Id])
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505151628445_Addresses', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5C5B6FE336167E5F60FF83A0A7EE22B593CC4B37B05B649C64117472D971D25DF465404BB44354A2548A4A132CFACBFAD09FD4BFB0A42E142FA275F7648B415E6C8AFCCEE1E1E177289EE3FCF1DBEF8BEF5EC2C079862441115EBA27B363D781D88B7C84774B37A5DBAFBF71BFFBF6AF7F595CFAE18BF343D9EF1DEFC746E264E93E511A9FCDE789F7044390CC42E4912889B674E645E11CF8D1FCF4F8F81FF393933964102EC3729CC5C7145314C2EC0BFBBA8AB007639A82E026F2619014EDECC93A43756E410893187870E95E4474158521241E9C5DE32D010925A947530267970C94BE5E11D6F99788FCE43AE701024CC3350CB6AE03308E28A04CFFB3C704AE2989F06E1DB306103CBCC690F5DB822081C5BCCEAAEE6DA7787CCAA738AF0696505E9AD028EC0878F2AEB0D95C1FDECBF2AEB029B36A6E283EEBCCB24BF7727BEEFB042689EBE8D2CE5601E13DBB583EFF8E603213C0478E34FC4878127338FE77E4ACD280232D314C2901C191739F6E02E47D0F5F1FA29F205EE23408E439B059B0674A036BBA27510C097DFD08B7C5CCAE7DD799ABE3E6FA40314C1A934FF91AD377A7AE73CB84834D00858B48E659D388C07F420C09A0D0BF079442823906CC6C6248D7643D201AC0521C734AB6EF5CE706BC7C8078479F962EFBE83A57E805FA654BA1C223466C9BB2416C116093942B4412CA3F4E2EE903389020E64B31C0AF93CB61C010D20389B94DC30D24D3DB2E73CC8985FC88E2C9655C860005934BB97F8AF0F40EBD66B001143C9C4B7B1F450104B8868264B0C5BC62F4069EBF233E241F109FCFD84C2FA0BF70BD45168561256F3247E2620E42C15CD03D419E9074013D1402B621EF09FB541C29BF719DB507B841EBACDB2CE102255EC4CE8B930AF93744BB27DAE40ACD388F647A3ACADC28043B7808616318E65F2928F6C71094693D2D23AF6632D0406EC133DA65DC5007E73A1F61903D4D9E509CBF87943CF949B025E3FA2B12851FA3A02268E9E9A7074076D90124B276594729F106C68489E2C19758502F8BBD829203C48235D3364DA63F5012C8AD7087C5FE645F1F108F411DF7217F7F788C7D8E36188B1365B29263473FE6198303ABDD3A2D8FAD19D3C4D9224F246064F5AD0CFA1E05019B87380FEFA152BDAB49A76A0FC1973AA56ADD4AE6ED44FA05A58FC1FC36356B82435B154BF7686356A3AFA9ACD6C5AAB1DEAF4E6D5BC03A4F92C84399926AC4D2D75D35C125F69D764E9053A3347346902C2AA198C521A6CFD2FDBB61DF467011B46570614815FE78363BD14D214DBA9D2D24A76A52B5CEC31A6D70E2EA31F70E5FC00052E89C7BF9A5E60A241EF0CD2DCED6D5EFA053ADE9A4D7D6A6B561670048781006C18AF9353B55204CCD0303C21E8A41D0681B6D64CBC3069FB690A13FB98031C4FC9CD0688436C2C5C9D5D44008D216A4C9443DFC4F278BA605B732C728BBD1C637236FC79CB098092933202485492E3635676976DE2B8ED34971A4D2E7C0A1D690162085723C4654B468AA6E58424591434D0D8CB4ABDA00ED013100248B5528B6802D75DE1FDA750F6F4DF2623ED5548CEDD29AD42530699974D6532DD0C13AF2A2D92D6323FCB694DFCF22353CAD03159A8F660EE31862B7C95E12EA4443FDAC63A39D810E539E8C04D154F9D1799E202D13A9734B2675710332C5A4CC6AD1E2ACF3B4EAEAEB75F7BC629863CCBDA426BD28B41592D81B33D841ED29CFE4F8304B50B1173DB001FC2561E587463746AB168E2A05E8CC692E58495EE508FEB920ED0E571C5B8B7F5556659D77210FF0D92D81B4FC7BC666D96E100052732BB18A8234C4F6C3867D74915F94018AA6F61852F650C6919ADB6355F94119AA6A6D8F2412803290686C8F5326F86498B2AD2B4A99BF33B1CA271DE697DD222993ABB957DA879065E06480ACA1FDF822BB2623144DED318ADC998C513475B0AD9A19538CAB3E323117736D4B1A876483158CB71795665A91D0DEE83C120B55A7B73E3CB467F4344C5466BF1484A2AD1B8AC91F556B37A4E2324B872A9ABB6155792A1DAE7AD20DB1BC77D4F1CAF66E6859B64887CA1A3BAEA1483D192B299EB447AC9B63F7F955192619A76AEDC057A64774F606F1462EA3585FD33F2F474DCD4FFDB9E950BC5466626484B2AD4BFCCF132D6AE4CFDB3AC4FC2A8FA204FEAAB9DB494B6452F4C39678D06DEF97D9147DE797ED87DEF74656C5D871F2C30EAB29B228CA7A8AD669F8646A1E505F305532B05DCD0CD9FB0658CB9DCEDFACF5A3E8DE1B19D392AD784203ABBF439574E9ADA6F52AB9379DEDD58BBD34FB28BBA3BD4E78FE4DE4DE3A4D5EBF90E8ED52C605CE209F32D0863B95E5DAA6E772E96823BA95E5B6EA4DF955F3F49B1DCBB8F0D2BB08A614175FDA05D7A2B86C6AFE3D8171FB9477E129EDE819F9FCE669FD9AB01837E31D66EB9F835580200F7665871B80D11626342F58714F8F4F4EB59F1EBC9D9F01CC93C40FDAFE16405DB50394DD206ED6C6C29A8E050B4A853D7E06C47B02E4AB10BCFC4D86EA55453F084DAF941F04A655C30FC2522BDE478052ABDA87CD532A231C042455A70FC2512AD007212955E6C3AC5E5749BE41748A2AF23F0747A895D9838CAF575F0F06530AAEFC4354584F22442DA2CB5671587DF560C3EA35D48300874F4FAF92EE8331ADAF6835D2998246A1C335F6E1CBD2FD6F36E6CCB9FECFA762D891937D38738E9D5F4766A23F090BA935C10303AF5CF73B2CE4EAB5BDFCE6888E54DBDB1BCBACEDEDB35F86EF5A4B5DEFE87B4FAFEB1D5DC0B4EAD7DC3674231103C04627AD7647CD3B6A37754C84F6FA4C58E8AA9DF9BA16BA3935452DFD4AF27A1661DA0B2BA62ABA6C25AAD545E1018B2DDB17FB7EFED2DEBCBCF07314F31ED08B2C59F8FFFF62DD2F843209A1B4BB231EDD23EAEB95CDFA3B7D05D55A6069FDF79526E7F7A8EC2CB189D892E7C1B06DDDB2C211FB0B97EBC4B4AF6B16FE672F6CB60A780335CFDA426825862D4A56B591F5F37A4BA5CC6D14B687214B05D49B2F56FEDCEBDCA102D94CBC30C292FEDD13E3CD04ED2A089E55C2D053A84AF4B9C6DBA8644F4DA3B28B76B4BF8114B0974A704E28DA028FB2C71EB351F6E6F40308526E927003FD6B7C97D238A56CCA30DC044A8D1067DE7DF2B3326B55E7C55D9CFD8A6E8C293035117F2FBEC3EF5314F842EFAB9A8B120B04A7F4E26282AF25E51714BB5781746B1460DA800AF38948F400C3386060C91D5E8367D847B7C7047E803BE0BD96F9333B48F342A8665F5C20B023204C0A8C6A3CFBCA7CD80F5FBEFD1F572251BAF54C0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505151722532_AddressesCorrections'
BEGIN
	ALTER TABLE [dbo].[Address] ADD [Country] [nvarchar](max)
	ALTER TABLE [dbo].[Address] ADD [State] [nvarchar](max)
	ALTER TABLE [dbo].[Address] ADD [Province] [nvarchar](max)
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505151722532_AddressesCorrections', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5CDB6EE436127D5F60FF41D05376E174DB9E97ACD19DC0D3B61746C6979DB6B38BBC0CD812BB4D44A2148A726C2CF26579C827E51796D485E2456A89BAF47883C1BCB829EAB0582C9EA2AA8AF3C76FBF2FBE7B0903E71992044578E99ECC8E5D07622FF211DE2DDD946EBFFEC6FDEEDBBFFE6571E9872FCE0F65BF77BC1F7B13274BF789D2F86C3E4FBC2718826416228F4449B4A5332F0AE7C08FE6A7C7C7FF989F9CCC2183701996E32C3EA698A210663FD8CF55843D18D3140437910F83A468674FD619AA730B4298C4C0834BF722A2AB280C21F1E0EC1A6F094828493D9A1238BB64A0F4F58AB0CEBF44E427D7390F106012AE61B0751D8071440165F29F3D26704D498477EB983580E0E13586ACDF1604092CE6755675EF3AC5E3533EC579F56209E5A5098D424BC0937785CEE6FAEBBD34EF0A9D32ADE68AE2B3CE34BB742FB7E7BE4F6092B88E3EDAD92A20BCA78DE6F3DF082633017CE448AF1F094B6206C7FF1D39AB34E0484B0C534A4070E4DCA79B0079DFC3D787E8278897380D02790E6C16EC99D2C09AEE491443425F3FC26D31B36BDF75E6EA7B73FD45F19AF44E3EE56B4CDF9DBACE2D1B1C6C02284C4452CF9A4604FE1362480085FE3DA01412CC3160A61363746DAC074403580EC78C92ED3BD7B9012F1F20DED1A7A5CBFE749D2BF402FDB2A510E11123B64DD94B6C1160DB2857882494FF39F9481FC0810662B61403FC3AF9380C18427AA0616ED37003C9F4BACB0C73E2417E44F1018C803912720823609B7BF251D8CF67C43CE1E4035D860005D34FE729C2D3CF65CD600328DC573EDAFB280A20C035CC2D832DE695236C718F77C487E403E2F319DB410AE82F2EB2612C0AC36ABCC90C890F7310CFC507BA27A8DAE717D04321601BF29EB0BF8A93F837AEB3F60057689D76DB47B84089C7D971D241FE0DD1EE89B699423BCE23999E8E32330AC10E1E62B03114F3AF1414FB6308CAB4969691573B196820B7E019ED326EA883739D8F30C89E264F28CE3FDF4A9EFC24D89271FD1589C28F515011B4F4F4D30320BBECDC163576594729F106FA8489FCC1175F503F16FB722707F005FCBC9726D31F5F09E45AB8C3627FB29F0F88FB20CB7DC83FBB1E639FA30DC6E24499AC64DFD18F79C6E0C06AB74ECB636BC63471B6C8130D30B2F88D0CFA1E05019B87380FEFA152BDAB49A76A0FC1973AA56ADD4AE6B522FD82D2C760FE26316B9C4357114BF3E8A256A3AF29ACD6A55162BD5F9DD84D0EEB3C49220F6542AA1E4B5F77550597D877BA19414E8DD2CC194132AF8462E687983C4BF7EF867E5BC185D396C1852255F8E3D9EC44578534E96EBA908CAA4DD43A0B6BD5C189ABFBDC3B7C010348A173EEE5B1E015483CE09B5B9CADAB6F2153ADEAA4CFD6B6B561670048B81306C18AD9353B55204CCD0303C21E8A41D0AA1BEDCD8E870D3E6D3186FEE402C610F37342AB12BA0C2E4EAEA60462206D41DA54D4C3FE74B2685BF046E618653736F1CDC8DB31272CA642CA140849A1928B4DCD599A9DF78AE374521CA9F43970A835A40548211CF711152D9AA21B9A50516457530323EDAA2E407B400C004963154A93C3963AEF77EDBA85772679319F6A2AC676E94CEA1298B44C3AEBA91AB0D08EBC68CD9A6922FCAE94DF4F23353CAD0315928FA60EE318D2AC93BD24644543FDB4D3443B030DA63C1909A2A9D2CAF33CAF5CE69FE70D09E8C50DC8049312D2458BB3CEB3D1ABAFD7F6E9D830C7987B494D5656482B46625FCC6007B5A73CF7E1C32CAFC73EF4C006F08F84951F1ADD18AD3670543980CE9CE68295E455BEC1FF2E48DB22C4B16DB0AF4AABACF32EE40E3E8B1248CBBFE7DDAC48000480D4442556519086B8F9B0D1FC76919695018AA6EE1852D255C6919ABB6355695519AA6AED8E24F2A6329068EC8E53E6456598B2CD16A54C7B9A58E5138BF965512465723571A57D0859E25206C81A6C345C2425550D178D36BAC9928EAA52B2A6EE18554A5186A95ABB2315394319A668B29026CF082AA2E44D165A51F37D8A76D44726E662AE118D71F437B8CEF82653C9B313B5EE3D738CC4ADD599B40FBBEE797B1A7E2D737A0A42D1668762B262D56A875484E874A8A2D90EABCABEE970D5133BC4329AAAE395ED7668590E4C87CA1A2DD75024D48C95144FBA23D6CDD17E7E55DE4CC6A95A6DD8D3B0086B6B10710619A531F8F079396A6A7EEACF4D87E2A532BF2423946D769E3BD59D53D166718EA8B243CA49A26AB63B3F8AFC907E84140FECF67E9923D2777ED97EE87D6FE48A8C1D273FB4584D911B52D653B44EC32753F380FAD9AC924153C069C8DE37C03AEE741E2FD08FA27BE34CA6263BF18406561F199664E92D666380BC379DED956B15611F6591E7EB8467154546D16AF27A98A5B7491961A9413665A00D37AA866054CFE5D2D14634AB8618DC9BB2ABF6E9B71B9611C6D3BB08A614E13C2D6CB7284268ED974B8C985ADE8527EAD917B3CFE369EBD784F9B819EF305BFF1CAC0204B9B32B3BDC008CB630A179198E7B7A7C72AADD43793B7742E649E2075D2F86A8AB76806222C4D5DA5A2E645986A15CB7C0CF80784F807C158297BFC950BDAE540C42D3AF4D0C02D3AE460CC252AF3F8C00A55E7118364FA938721090745561A0E295EB0803B5255D391884A45F2B1804A65C1D1826967C3D6098AAEAAE006C109DA2FCFFCF41836A49FD20E5EB65F383C1944A39FF10A5F1930CA2563F66AB38AC307EB062F5E2F74180C3A7A797B7F7C198D656B4E2F64C40A342E51AFBF065E9FE377BE7CCB9FECFA7E2B52327FBE3CC39767E1D9989FE242CA416730FF69655C1F63027AE1765F3E0181DA928BB37965994DD67BF0CDFB50D05D9A3EF3DBD207BF401A615BF26A06247220640139D74DA1D359FE176E29808DDE599B042593BF3D956283A35D548FD6A297B56CF3657C44C552DDB69A84EB1D00356C976AFD2FEFC35D9795DE8E7A8C23EA01535141AFCFF57597F21944908A55B187C748BA82F34370B27F515548BB8A5F5DF57539E878AD9596213B125CF9D61D782738523F6579CD70DD3BD205DD85F73457AE3006FA0585D5B08AD36B443ADB1F666FDBCDE520D7A17819BDD504391D79BAF32FFDCEB6C513A6EE696186149FFBD19E3CD04ED2A089E38C3D053A84AF4B9C6DBA8644F4DA2B28B76B4BF8114B08F4A704E28DA028FB2C71ED351F6E5F4030852AE927003FD6B7C97D238A56CCA30DC044A191467DE7DE367F5F1AACC8BBB38BBFE38C6149898887F17DFE1F7290A7C21F7554DA0A40182537A1198E06B49798062F72A906E8D1AD326A0427DC2133DC0300E18587287D7E019F691ED31811FE00E78AF658AB019A47D2154B52F2E10D81110260546F53EFBC96CD80F5FBEFD1F5C6628F9E54F0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505192107369_OrderLog'
BEGIN
	CREATE TABLE [dbo].[OrderLog] (
		[Id] [int] NOT NULL IDENTITY,
		[OrderId] [int] NOT NULL,
		[DateTime] [datetime] NOT NULL,
		[Action] [nvarchar](max),
		[Value] [nvarchar](max),
		[OldValue] [nvarchar](max),
		[EfOrder_Id] [int],
		CONSTRAINT [PK_dbo.OrderLog] PRIMARY KEY ([Id])
	)
	CREATE INDEX [IX_EfOrder_Id] ON [dbo].[OrderLog]([EfOrder_Id])
	ALTER TABLE [dbo].[OrderLog] ADD CONSTRAINT [FK_dbo.OrderLog_dbo.Order_EfOrder_Id] FOREIGN KEY ([EfOrder_Id]) REFERENCES [dbo].[Order] ([Id])
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505192107369_OrderLog', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5CD96EE4B8157D0F907F10F494049E2ADBFD3231AA66E02EDB8191F6922E7B12E4A5C192586562B45424CAB111E4CBE6613E29BF10520BC54594482D654FA3D12F2E8A3CBCBCBC3C97CBBDFDBF5F7E5DFCF81206CE334C5214474BF76476EC3A30F2621F45BBA59BE1ED77DFBB3FFEF0FBDF2D2EFDF0C5F9A9AAF781D6232DA374E93E61BC3F9BCF53EF0986209D85C84BE234DEE299178773E0C7F3D3E3E33FCF4F4EE69040B804CB71169FB308A310E63FC8CF551C79708F3310DCC43E0CD2B29C7C59E7A8CE2D0861BA071E5CBA17315EC56108130FCEAEA36D02529C641ECE1238BB24A0F8F52A2195FF1D273FBBCE79800091700D83ADEB80288A31C044FEB3C714AE711247BBF59E1480E0E1750F49BD2D0852588EEBACAE6E3AC4E3533AC479DDB082F2B214C7A125E0C987526773B9792FCDBB4CA744AB85A2E8A873CD2EDDCBEDB9EF27304D5D47EEED6C1524B4A68DE68BDF08A633067CE470CD8F98251183A3FF8E9C551650A46504339C80E0C8B9CF3601F2FE0A5F1FE29F61B48CB220E0C7404641BE0905A4E83E89F730C1AF9FE1B61CD9B5EF3A73B1DD5C6EC89A716D8A215F47F8C3A9EBDC92CEC12680CC4438F5AC719CC0BFC008260043FF1E600C938862C05C274AEF525F0F0807B0EA8E18255977AE73035E3EC168879F962EF9D375AED00BF4AB925284C70891654A1A9149805DBD5CA124C5F4CFC97BFA040ED411B1A53D885E27EF870043880FD4CD6D166E6032BDEE72C39CB8937FA2FD018C803892E410464016F7E4BD909FCF8878C2C93BBA0C010AA61FCE531C4D3F9635810D20735F456F1FE33880206A606E1E6C31AF1D61877BBC4B7C987C42743C633B4806FDCD456AFAC230ACFB9BCC90683707F15CB4A3FB04D5EBFC027A28046441DE27E4AF7227FEBDEBAC3D4015DAA4DDEE1E2E50EA51769CB493BF43B47BC25DA6D08DF3984C4F47B9198560070FD1D9188AF95B06CAF53104655A4BCBC9AB9B0C24905BF08C76393734C1B9CE6718E45FD327B42F8E6F154F7E616C49B8FE2A89C3CF71501334F7F5CB034876F9BE2DD65659C759E20DF40913F9836FBEA0B92F72724F0EE00BE87E2F4BA7DFBE26906AE12E62EB93FC7C40D40759AE437AEC7ADCFB146D301625CA74C5FB8E7ECC330607D6AB755A1E5B13A6D9E7933C5107238BAF65D08F2808C838D87EB8854AE5AA2A9D8A35185FCA942A55AB98D78AF44B4A1F83F975623638073B11E39D8984792D9D80E463877CB486AD7895F59ACCBA52571555AAA21558AED724B6F5192BDE4D75C48A77DFBC6A0BCB5AEFE22490DADF0CF43FE75E71CB3DB1F3FD0904D9F487BDBBC09FA223DDB23A4FD3D843B95188EB4A667B51E8CBC877CCA8BF18044728642864D5A03D5927449EA5FB2745239DE06CABCE83337E12E18F67B3135915DCA0CD74C1B9922E519BFC4AA70E4E5C9913EEA20B18400C9DC2B8C9D60FA41EF055F321F3EA5BC8D4A83AEEB2AA6B6E0847C18492040856C45D10D6431156090D451EDA83A05337524B4332A4C3667DC85F2EE01E4694C73A9560D239633A5502D69134215D2AEA6D7F74A36036D5C2AEA1D3FAD425D201DD6244D41BB7DA508FD1CB3B902E41B5DB9151B848B78919998C0ABA26068489F9C0A4F2999B86CD0E39E396FB9DB4A47E790C146A0D71E52F0BE1E8BEB8760AAAE88A2644147E7BDD00C3718A09500B88A124F9365A2B08B54B0986537C8DA53BEB7095DB4F45324D187B4A36AA5A230AE7187B460E8C9B6DD975881AB0D00E3FF77ACDE8BCA6A9DFECA7910667270395928FAC8EDC00BBB4A170B8218B0FD1054FD98A2A72A947D3847258D4EBA395D5AD78BD9F6E743C3E70E9541B6DC6DC756CD2BC084EAA8298E69A28A6C50DC805E3A29ACA12675D8434ADBE5BDBC7F48405C6DC4B1B427B98B4AC277240043B287DA50FE83ECC8343C8690D6C003D75ACFC50A946FC9486B3AB0E6457A44E58C5E4550BFA77E9052D0EF55B8D7DD55A25957721DD2FE687626EFA5BDAE69166200049C3217C15075918E9F7AEFAD6656C0F0F5016996370913B3C0E576C8E55C7E6F05075A939120BBEE18158A1394E155CC3C35465B62855EC8C8A557DB1185F7E69220CAEE11AA50D218F7EE101F2021B0D97912DA286CB421BDDE4912BA252F222738C3A2E8587A94BCD91CAC0131EA62CB290A6082B1144298A2CB422068D08DA113FA9988BB94434CA4952E13AE5882F92A711B5B6EEBE46E2D67A93DF875D5B5A4FC3AF556088805096D9A1A8AC5897DA2195EF3C3254596C87558770C870F5173BC4EA494EC6ABCAEDD0F2400A192A2FB49C431695A1CC24FB628ED83446FBF1D5C1173C4E5D6AC39E8A45585B03BBB6E251B477596FCB5153F3537F6E3A142F55410A3C425566E7B933D939956516FB883AC440D849D4C576FB471664206F21D907BBB55F051AC82BBF2A3FF4BA57020E9415C77FB4984D166020CC272B9D864FDE74AFD27C3732EA5625DE0DD8A934359E86106CE95B87533FA9F24075A93952F5C6CAE35465E628E5CB260F521659E8863D900ACA61A587376AF12E48B46CDD7DF2102B56C00CDD17BD0493CF57ADD7C8AA268D6C5D026B7E3DE364E92DA6F611B1F7926C956B15473ECADFA7AE531AA2C0DEDDAD062FDF1DF63629EEFE7690357138E6CCD73249CAE575CFF9A9F046B41FE53EFC5D998E7EC0A3D98C723F3FC87214B4E144A4B995EF394F32DA88A6A4798C785706D53DFC6EC352DE33E42ACCBBB2770DE9FD6251BE2574A76A2B8F0B45151AF61A3F239F3E2CAC5F53B2D99FD10AB3F5BF82558020DDF557156E4084B630C545F89D7B7A7C722A6575BF9F0CEB799AFA41C35B4C639AB5386B0708224454AD9D618296917A42F272F40C12EF09247F08C1CB1F79A85E09CA83D0E424E4416052A2F1202C3199780428316178D838B954A341405CE2EF40C50BC9BD03B5C525F00E4292937407810989B8C3C4E2936D87A9AA29A17683F014C9B45F070D8A09AA83942F27A10E0613F24EFC43249A4ED289984B94CFE2B034D3C18A95534907010E1F9E9C2CDA07635A5B91920C720195D8C7EBC8872F4BF73F799B33E7FA1F5FCA66474EFEC79973ECFC776426FA4A58484C8D1CEC2DEBF4C7614E5C4E71A4AF0478A414C7DE586A8A639FF5327CD52A0F0A13AD3D39BD71F40EA615BFE112CE8E4414001D9D18AD8E8663B89D382A82B93C7D12EABE0E826B72200373D47A138898A336882185F4B0414872AED9B0A309777B6967DD75CBE1563D423E9B7492B1CDE8701A828DFBE59EF4CCB5D207BC4E955B65D495D1ABD0C173AA4C72FADE3E83AFC8A3798B9CBD035A91268EF0379F93375E0A5E9EC5D427E9EE3764048D111A6A6FED8F83073403F3E4C46F7E6512BF62F6C637BA4534E767AAE931F20C8AA98BDCFCB7A56216EF6064FBB989C994177B22D33C4DC155B4276A3675639EC7C9EC4F9FC8A9EDC0781494EA5A933CF563781729A0D2744B794606796B52CB66EDBDA7CC4E1381F57B1E4DC2C0D8031E2F77B3F7706BCB96436FC61BEC44E9996F6DD41639976A2C02F101DC7F2E4F5C518A7635040DB488A027B03FAB731D6DE3CA2149125555A443F20DC4C027AEE13CC1680B3C4C3E7B4447F94D5B7E14A74F7C1BE85F477719DE67980C19869B40C81FA0CEACADFF3CB154947971B7CFFF77A7318640C444F41AE42EFA98A1C067725F355CAC6B20A8972CEF79E85C627ADFB37B6548B74A72960EA8541F73EE0F30DC07042CBD8BD6E019F691ED31859FE00E78AF5548891EA47B2244B52F2E10D825204C4B8CBA3DF9496CD80F5F7EF83FE964E9FF63610000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505192129587_TableRenaming'
BEGIN
	EXECUTE sp_rename @objname = N'dbo.Address', @newname = N'DotCommerceOrderAddress', @objtype = N'OBJECT'
	IF object_id('[PK_dbo.Address]') IS NOT NULL BEGIN
		EXECUTE sp_rename @objname = N'[PK_dbo.Address]', @newname = N'PK_dbo.DotCommerceOrderAddress', @objtype = N'OBJECT'
	END
	EXECUTE sp_rename @objname = N'dbo.OrderLine', @newname = N'DotCommerceOrderLine', @objtype = N'OBJECT'
	IF object_id('[PK_dbo.OrderLine]') IS NOT NULL BEGIN
		EXECUTE sp_rename @objname = N'[PK_dbo.OrderLine]', @newname = N'PK_dbo.DotCommerceOrderLine', @objtype = N'OBJECT'
	END
	EXECUTE sp_rename @objname = N'dbo.Order', @newname = N'DotCommerceOrder', @objtype = N'OBJECT'
	IF object_id('[PK_dbo.Order]') IS NOT NULL BEGIN
		EXECUTE sp_rename @objname = N'[PK_dbo.Order]', @newname = N'PK_dbo.DotCommerceOrder', @objtype = N'OBJECT'
	END
	EXECUTE sp_rename @objname = N'dbo.OrderLog', @newname = N'DotCommerceOrderLog', @objtype = N'OBJECT'
	IF object_id('[PK_dbo.OrderLog]') IS NOT NULL BEGIN
		EXECUTE sp_rename @objname = N'[PK_dbo.OrderLog]', @newname = N'PK_dbo.DotCommerceOrderLog', @objtype = N'OBJECT'
	END
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505192129587_TableRenaming', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5CD96EE4B8157D0F907F10F494049E2ADBFD3231AA66E02EDB8191F6922E7B12E4A5C192586562B45424CAB111E4CBE6613E29BF109292282E5A482D654FA3D12F2E8A3CBCBCBC3C97CBBDFDBF5F7E5DFCF81206CE334C5214474BF76476EC3A30F2621F45BBA59BE1ED77DFBB3FFEF0FBDF2D2EFDF0C5F9A9ACF781D6232DA374E93E61BC3F9BCF53EF0986209D85C84BE234DEE299178773E0C7F3D3E3E33FCF4F4EE69040B804CB71169FB308A310B21FE4E72A8E3CB8C719086E621F0669514EBEAC19AA730B4298EE810797EE458C577118C2C483B3EB689B8014279987B304CE2E09287EBD4A48E57FC7C9CFAE731E2040245CC360EB3A208A620C3091FFEC31856B9CC4D16EBD2705207878DD43526F0B821416E33AABAA9B0EF1F8940E715E352CA1BC2CC571680978F2A1D0D95C6DDE4BF32ED729D16AAE283A6AA6D9A57BB93DF7FD04A6A9EBA8BD9DAD8284D6B4D17CFE1BC174C6818F1CA1F911B7246270F4DF91B3CA028AB48C608613101C39F7D92640DE5FE1EB43FC338C96511604E218C828C837A98014DD27F11E26F8F533DC1623BBF65D672EB79BAB0D7933A14D3EE4EB087F38759D5BD239D804909B88A09E358E13F81718C10460E8DF038C6112510CC874A2F5AEF4F5807000CBEE88519275E73A37E0E5138C76F869E9923F5DE70ABD40BF2C2944788C1059A6A4119904D8D5CB154A524CFF9CBCA74FE0401D115BDA83E875F27E083084F840DDDC66E10626D3EB8E19E6C49DFC13ED0F6004C49124873002B2B827EF85FC7C46C4134EDED165085030FD709EE268FAB1AC096C00B9FBCA7BFB18C70104510D738B608B79E5083BDCE35DE2C3E413A2E319DB4172E86F2EB2A12F0CC3AABFC90C89767310CF453BBA4F50B5CE2FA087424016E47D42FE2A76E2DFBBCEDA0354A175DAEDEEE102A51E65C7493BF93B44BB27DC650ADD388FC9F474C4CC28043B7888CEC650CCDF3250AC8F2128D35A1A23AF6E3250406EC133DA316EA883739DCF30605FD327B4CF8F6F254F7EE16C49B8FE2A89C3CF715011B4F0F5CB0348766CDF16375659C759E20DF40913F9836FBEA0BE2F72724F0EE00BE87E2F4BA7DFBE26906AE12EE2EB93FC7C40D40759AE437AEC7ADCFB146D301625CA7425FA8E7ECC33060756AB755A1E5B13A6D9B3499EA88391C56F64D08F2808C838F87EB8854AD5AA3A9DCA35385FAA94AA542B99D78AF40B4A1F83F99BC4AC710E7622C63B130959AD2601C9C70EF9680D5BF14AEB359975ADAE2EAA52A55160B55E9DD8D667AC7837D5112BDE7DF3AA2D2C6BBD8B53402A7F33D0FF9C7BF92DF7C4CEF7271064D31FF6EE027F8A8E9A96D5799AC61E624621AF2B95ED65A12F23DF31A3FE7C1002A190A1905583F6649D107996EE9F348D7482F3ADBA08CEF949863F9ECD4E5455088336D385E04ABA44ADF32B9D3A3871554EB88B2E6000317472E3265B3F907AC0D7CD87CCAB6F2153ADEA84CBAAAEB9211C05134A122058117741580F455827341479680F824EDD282D0DC9900E9BF7A17EB9807B18511EEB548249E79CE974097847CA8474A9A8B7FDD18D82D9544BBB864EEBD3974807748B11516FDC6A433D46AFEE40BA046DDC8E8CC2454D9B9891C928A76B624098980F4C4A9FB9A9D9EC90336EB1DF490BEA57C740A1D61097FE32178EEE8B2BA7A08BAE69424611B7D7353002A79800B580184AC2B6D18D8250BB546004C557584D671DA172FBA948A509634FC947556944E31C63CF288009B3ADBA0E590316DA11E7BE59334D5ED3D46FF6D3488DB353810AC947560733C02E6D681C6EC8E243742152B6A60A26F5689AD00E8BCDFA6865752B5EEFA79B261E1FB874CA8D3667EE2A36699E072795414CF38628A6C50D608209514D4589B3CE439A56DFADED637AC21C63EEA535A13D5C5ADE133920821D54BED207741FB2E010725A031B404F1D2B3FD4AA113FD5C0D96507AA2BD227AC64F2B205FDBBF0821687FA6D837D555A25957721DD2FB243B130FD2D6D59A41908405273085FC5411646CD7BD7E6D6456C8F085014996308913B228E506C8E55C5E6885055A939120FBE118178A1394E195C23C29465B62865EC8C8E557EB1181FBB34910657738DD286C0A25F44005660A3E122B245D6705168A31B16B9222B85159963547129224C556A8E54049E883045918534795889244A5E64A115396844D28EFC49C75CCC15A2D14E921AD769477C993C8DA8B575F73512B7569BFC3EECDAD27A1A7E2D03432484A2CC0E4567C5AAD40EA978E751A18A623BAC2A844385ABBED821964F722A5E596E87C602295428566839873C2A439B49FEC51CB16E8CF6E3AB822F449CAAD4863D358BB0B6067E6D25A234DE65BD2D474DCD4FFDB9E950BC540629880865999DE7CE54E7549459EC23AA100369275115DBED1F799081BA85E41FECD67E1968A0AEFCB2FCD0EB5E0B38D0569CF8D16236798081349FBC741A3E79D3BD4AFDDDC8A85B95783760A752D7781A42B0A5EF269CEA495504AA4ACD91CA375611A72C3347295E364590A2C84237FC8154520E2F3DBC51CB7741B26537DD270FB1620DCCD07DD14B30F57CD57A8DAC6BD2C8D615B0FAD7334196DE62363E22F65E92AD72ADE2C847EC7DEA3AA5210AFCDDDD6AF0EADD616F9312EE6F0759938063CE7C2D93A45D5EF79C9F126F44FBD1EEC3DF95E9340F78349BD1EEE707598E86369C881A6EE57BCE938A36A229353C46BC2B83EA1E7EB76169EF196A15EE5DF9BB86F27EB128DE12BA53B5B5C785BC0A0D7B8D9F914F1F16D6AF29D9ECCF6885D9FA5FC12A4090EEFACB0A3720425B98E23CFCCE3D3D3E3955B2BADF4F86F53C4DFDA0E62DA636CD5A9EB503041122AAD6CE3041CB483D2979397A0689F704923F84E0E58F2254AF04E541686A12F2203025D17810969C4C3C02949C303C6C9C42AAD1202021F177A0E2A5E4DE81DA1212780721A949BA83C0A444DC616289C9B6C354559750BB41788A64DAAF8306E504D541CA5793500783497927FE21124D27E944CE2562B3382CCD74B062D554D24180C387A7268BF6C198D65694240326A016FB781DF9F065E9FE87B53973AEFFF1A56876E4B03FCE9C63E7BF2333D157C242726AE4606F59A53F0E73E26A8A237D25C023A538F6C6D2531CFBAC97E1AB567B509868EDA9E98DA37730ADF83597707624A20134D189D1EAA83986DB89A32398CBD327A1EEEB20B83A07323047AD3781C8396A8318524A0F1B84A4E69A0D3B9A08B79776D65DB51C6ED523E4B3292719DB8C0EA726D8B85FEE49CF5CABE680D7A972AB8CBA327A153A784E95494EDFDB67F0E579346F91B377402B6A8823FCCDE7E48D9782C7B298FA24DDFD868CA0364243EFADFD71F08066609E9CF8CDAF4CE257CCDEF846B788FAFC4C3D3D469D4139755198FFB654CCFC1D8C6C3F373199F27C4F24BCD7326599E66D4AAEA33D71D3A45BA3144F6E9ACD399E267D198F8D12626B2AA8D1C8DE45CEA8621F4A629241A29BD2B25E91EF2915D444E0E64D524386C1D8031E2FD9B3F7702B23576375C61BEC44F99C6F6DD416499A7AF002711AC2FF464F7C578A7615048DCC88A027B90B5EE73ADAC6A50753242AAB28A7EA1B88814F7CC97982D11678987CF6888ED8D51C3BBBD337C10DF4AFA3BB0CEF334C860CC34D20251C50EFD7D63FCB4495655EDCEDD97F0735C610889888DE9BDC451F3314F85CEEAB9A9BF80608EA568B8B213A97985E10ED5E39D2AD96CDD50454A88FEF061E60B80F08587A17ADC133EC23DB630A3FC11DF05ECB18946690EE8990D5BEB840609780302D30AAF6E427B1613F7CF9E1FF28C04E2E94610000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201505192143520_OrderLogCorrections'
BEGIN
	IF object_id(N'[dbo].[FK_dbo.DotCommerceOrderLog_dbo.DotCommerceOrder_EfOrder_Id]', N'F') IS NOT NULL
		ALTER TABLE [dbo].[DotCommerceOrderLog] DROP CONSTRAINT [FK_dbo.DotCommerceOrderLog_dbo.DotCommerceOrder_EfOrder_Id]
	IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_EfOrder_Id' AND object_id = object_id(N'[dbo].[DotCommerceOrderLog]', N'U'))
		DROP INDEX [IX_EfOrder_Id] ON [dbo].[DotCommerceOrderLog]
	DECLARE @var0 nvarchar(128)
	SELECT @var0 = name
	FROM sys.default_constraints
	WHERE parent_object_id = object_id(N'dbo.DotCommerceOrderLog')
	AND col_name(parent_object_id, parent_column_id) = 'OrderId';
	IF @var0 IS NOT NULL
		EXECUTE('ALTER TABLE [dbo].[DotCommerceOrderLog] DROP CONSTRAINT [' + @var0 + ']')
	ALTER TABLE [dbo].[DotCommerceOrderLog] DROP COLUMN [OrderId]
	EXECUTE sp_rename @objname = N'dbo.DotCommerceOrderLog.EfOrder_Id', @newname = N'OrderId', @objtype = N'COLUMN'
	ALTER TABLE [dbo].[DotCommerceOrderLog] ALTER COLUMN [OrderId] [int] NOT NULL
	CREATE INDEX [IX_OrderId] ON [dbo].[DotCommerceOrderLog]([OrderId])
	ALTER TABLE [dbo].[DotCommerceOrderLog] ADD CONSTRAINT [FK_dbo.DotCommerceOrderLog_dbo.DotCommerceOrder_OrderId] FOREIGN KEY ([OrderId]) REFERENCES [dbo].[DotCommerceOrder] ([Id]) ON DELETE CASCADE
	INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
	VALUES (N'201505192143520_OrderLogCorrections', N'DotCommerce.Migrations.Configuration',  0x1F8B0800000000000400ED5C4B6FE4B811BE07C87F10744A026FB7EDB96C8CEE5D78DA766064FCC8B4BD097219D0125B26568F0E45393682FCB23DEC4FCA5F08A907C587D422F568F70E06737153D457C562B1AA58AA9AFFFDF2EBE2C7D728745E204E51122FDD93D9B1EBC0D84B7C14074B37239BEFBE777FFCE1F7BF5B5CFAD1ABF35335EF039B47DF8CD3A5FB4CC8F66C3E4FBD6718817416210F2769B221332F89E6C04FE6A7C7C77F9E9F9CCC2185702996E32C3E67314111CC7FD09FAB24F6E0966420BC497C18A6E5387DB2CE519D5B10C1740B3CB8742F12B24AA208620FCEAEE30D0629C19947320C67971494BC5D613AF9DF09FED975CE430428876B186E5C07C4714200A1FC9F3DA6704D701207EB2D1D00E1C3DB16D2791B10A6B05CD7593DDD7489C7A76C89F3FAC50ACACB5292449680271F4A99CDD5D77B49DEE532A5522D04C5569D4B76E95E6ECE7D1FC334751D95DAD92AC46CA68DE48BDF08A6330E7CE408AF1F714DA20AC7FE1D39AB2C6448CB18660483F0C8B9CF9E42E4FD15BE3D243FC37819676128AE81AE823E9306E8D03D4EB61093B7CF7053AEECDA779DB9FCDE5C7D91BF26BC532CF93A261F4E5DE79612074F21E42A2288674D120CFF0263880181FE3D2004E29861C05C261A7585D6032221ACC851A5A4E7CE756EC0EB271807E479E9D23F5DE70ABD42BF1A2959788C113DA6F425BA09B08BCA15C229617F4E4EE913D81321AA4B5B10BF4D4E87024348F644E6368B9E209E5E76B9624E4CE49F68BB0725A08E04EF4309E8E19E9C0AFDF982A8279C9CD065045038FD729E9378FAB5AC296C08B9FB2AA87D4C921082B8C1728B608B79ED083BDCE31DF621FE84D87AC676901CFA9B8B6CA1456054D39B4C911899BD782E46E81EA3FA9C5F400F45801EC87B4CFF2A23F1EF5D67ED0126D026E97653B840A9C7ACE3A444FE0E51F04CBA54A11BE7114F6F8E72358A4000F7416C0CC1FC2D03E5F9188232ADA6E5C6ABDB182820B7E00505B96D6882739DCF30CC9FA6CF685B5CDF2A3BF9855B4B6AEBAF70127D4EC2DA400B4FBF3C001CE4715BD23A659D64D81BE81326F207DF7C41332D7A73C77BF0052CDECBD2E9C3570C9914EE627E3EE9CF07C47C90E53964D7AEC7ADCFD00663314399AE44DFD1CFF28C6103EBD33AAD1D5B534BB3CD3779220223B3DF6A413FA230A4EBE0F1F00E53AA4ED5CDA93C83DB4BD5A42AD32ACB6B65F44B933E86E56F63B3C139D8B19804261CE6B3DA18A40F3BF863336CD9ABB4D764D7B5B93AABCA945686D5794D6C5BDFB19260AA2B56127CF3AACDB46A5731D0759C7B45827A62BFF91308B3E9EF6977A1BF2742EF1344771AAADD21B468CA4C4EFC799A261ECA59928FBCEA88E4655EC6BE63E6958A4D12D649B78A1E68B4A54798F2B374FFA4C9B0139C8B4004E7A653863F9ECD4E5451088B369385E0E5BA586D72799D323871557375175FC01012E814879746A520F580AF2B1CDD57DF82A746D10979B4AEBDA1E6136266BF40B8A25A4C0D328A896E6B51ECA12D083B65A3BC6968A7D9B2390DF5C905DCC29899D84E219810E75640E780135236A44B44BDF58F9906B3AD96029AC3D03EC974E9CAC7028C3DE89E2098BDAB9E2081DF8EE6A98169D766B746A9A3F881B6D876644750B84A2A4242050871158F3D35C4C08F292CC3E0B40C2BD43530A83524552C5630C7AE4BB543D659D72421A388B7AE0618C19E9B00ED0031E4240F5A5A1961675B8111045F63B55D8185C9BB2FCBEA41318E52F8AA6A8968A7CE382A11C084DD560DA72C010BE9887BDF2E99B688C53466E92791864043052A391F591CB902764943F39F861E74882C44B7A78922E77A34496839847679ECB4EA5676BD9F6CDAECF8C0A3535D72B8E5AE4BD6E645CD5A39B098B714B72D6E40CE9850EC568E38EBA2D26DF5DDDABED42B2A30E65EDA50F1C5B9E5944882410095A7ACAEC28779CDD00520E009B0DBE7CA8FB469D44FB5D8EC8A80EA8AF40DAB2C79F506FBBBF48216B99E4D8B7ED552A5938388054C79AE44D8FE1DEF3AAC0011840037E46656499845717BF0D6FE7659F225029443E61842419788230C9B63D5255B22543D6A8EC46BB244203E688E53D55C8930D5982D4A5552A563554F2CD697E7D2A4C53564D77621E4455122403E6023E1B2E04996703968239BBCA049164A3E648E51972B8930F5A83952598F24C2944316DC14D546122BC5908554E45A22493AF2231D7331570C8D7697D26C9D76C1958DA79169DD197D8D645BEB20BF8F75DDF1F634F6B5AA179210CA313B14DD2AD6A37648E5E73F15AA1CB6C3AA2B7B54B8FA891D62F5A556C5ABC6EDD0F2FA1A152A1FB4DC435EACA3ED247F628ED8B446FBF5D53539224E3D6A633D358DB0D6069EB811515AB339EF6BA3A6B64FFD6DD3BEEC5255BB22225463769E3B539D5339661147D495275224510FDBC58FBCF6440D21F903BBB35FD59FA827BF1ADFF7B9D7EA50B413273EB4D84D5E7722ED271F9DC69EBC6BACD29C1B193554498201914AD3CBD31884FA33BB88518F9A2355DFDD459C6ACC1CA5FCDA2D8294431607857F34974E081FFDED3A373917246B765B3E7988166B6086EE8B25C1D4FBD5CE34B22E49235D57C09ABF1F09BCF466B3F52B5AEF23B993AF5512FB28FF3E759DB21A0C5E7F61B5783577D85BA5B45CEB209DD2D0862B554B86B5E776A96823AA554B62F9A0F4AA7BF9DD8AA5E5A6D529DC52F21CB5928B5E9479E1EE6E6C2D515C4C6195ADC90BF2599278FD96D2C06DC626CCD6FF0A5721822C82AB26DC80186D604A8A0A3BF7F4F8E45469DC3E9C26EA799AFA61435EBDB1935ADEB53DD4092226D6CE4A40CB8A3EA93F397E01D87B06F80F1178FDA308D5AB0779109ADA673C084CE9251E8425F70B8F0025F7040F5BA7D04D340848E8ED1D2878A97F77A0B4841EDD41486A1FEE2030A9D776185B623FED305135F5CC3E213245BFECD76106E51ED441C257FB4C078349AD25FE3E7A49272122B70BE5BB38AC9374B060D56ED14180C397A7F683F6C19856579442F69C41AD8EED3AF6E1EBD2FD4FFECE9973FD8F2FE56B474EFEC79973ECFC77644BF4955821B9FB71B0B7AC3B1C873971B58B91657CC9485D8CBDB1F42EC63EE765F8A9D592C3139D3DB583717402D3B2DF9050B133221A409B39313A1D0DD7703B767404737EFAF4CC7D1D064E6D44EB7DFAE546B441E64DEA011B84A436940D037B6F5F3B423F977203B1ADAA771A0A3EFBD5FFF7ECF7682F3A9CAAC1C3889451667EEF3D45263D6DEFDF4354F432BC47CFDA1EB5A8A596EB503B838C7BD20E407D92A0517BA66E3ADBA7F2347E5D3F54DD31EF2AFBE68C267146661FF446D788E6C63ABDAF41DD41B9E74CD8FF5D3D74C5472F1AAE3E2574CB8B484AF8389B0BCBB4E14EF237BB3BEE4CC81AF5E671D56C6FCE33A165BC36660D77F6F019ADEC209AFD14FD503A4A0C3A9494379B0579483D7C260CB747562DA5E187DBA5D77BB9B592ABE56507DF88F7DE4A6DD15DA7572A50A721FCEFF2D477A528A8215819460C3DC95DF039D7F126A93C98C2513545B985DF40027CEA4BCE31411BE011FAD8A332CAF370F95D9F7D007C82FE757C97916D46E89261F4144A95E2CCFBEDA29FB710CA3C2FEEB6F97FED32C612289B88E559EEE28F190A7DCEF755432AA00582B9D5320BC4F692B06C50F0C6916EB5369C36A0527C3C1A7880D136A460E95DBC062FB00F6F8F29FC0403E0BD550527ED20DD1B218B7D7181408041949618F5FBF427D5613F7AFDE1FFCCF3154064610000 , N'6.1.3-40302')
END

